PS C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN> C:/ProgramData/Anaconda3/envs/tf/python.exe c:/Users/Tuna/Desktop/2022-spring/CS402/SPDPvCNN/training.py
2022-05-30 03:59:24.404482: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-05-30 03:59:24.763365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3495 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.6
wandb: Currently logged in as: kuantuna (spdpvcnn). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.12.17 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.16
wandb: Run data is saved locally in C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run magic-galaxy-46
wandb:  View project at https://wandb.ai/spdpvcnn/vision_transformer
wandb:  View run at https://wandb.ai/spdpvcnn/vision_transformer/runs/2f5vqayx
Training data samples: 32465
Validation data samples: 3607
Test data samples: 9018
2022-05-30 03:59:31.485132: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
2022-05-30 04:01:12.988705: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Getting the ViT model...
wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
2022-05-30 04:01:53.910193: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
2022-05-30 04:01:54.148363: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Epoch 1/100
lr at epoch 1: 0.0010000000474974513
2022-05-30 04:01:59.742300: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-05-30 04:02:02.025405: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
127/127 [==============================] - 23s 121ms/step - loss: 2.5902 - accuracy: 0.2606 - top5-acc: 1.0000 - val_loss: 1.3787 - val_accuracy: 0.2384 - val_top5-acc: 1.0000
[[ 730  269  798]
 [2388  923 2314]
 [ 671  212  713]]
f1 score: 0.2624506592214601
36/36 [==============================] - 2s 39ms/step - loss: 1.2792 - accuracy: 0.2624 - top5-acc: 1.0000
buy&sell test accuracy_t: 1443 / 3393 = 0.4253
buy&sell test accuracy_o: 1443 / 7614 = 0.1895



wandb: ERROR Can't save model in the h5py format. The model will be saved as W&B Artifacts in the SavedModel format.
2022-05-30 04:02:25.309288: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.2s
2022-05-30 04:02:40.594478: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Epoch 2/100
lr at epoch 2: 5.0036192988045514e-05
127/127 [==============================] - 15s 113ms/step - loss: 2.4753 - accuracy: 0.2708 - top5-acc: 1.0000 - val_loss: 1.3019 - val_accuracy: 0.2620 - val_top5-acc: 1.0000
[[ 725  389  683]
 [2369 1358 1898]
 [ 678  329  589]]
f1 score: 0.3156129092094484
36/36 [==============================] - 2s 39ms/step - loss: 1.2155 - accuracy: 0.2963 - top5-acc: 1.0000
buy&sell test accuracy_t: 1314 / 3393 = 0.3873
buy&sell test accuracy_o: 1314 / 6942 = 0.1893



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.2s
Epoch 3/100
lr at epoch 3: 7.50361941754818e-05
127/127 [==============================] - 15s 113ms/step - loss: 2.3294 - accuracy: 0.2930 - top5-acc: 1.0000 - val_loss: 1.2105 - val_accuracy: 0.3191 - val_top5-acc: 1.0000
[[ 715  572  510]
 [2211 2064 1350]
 [ 644  509  443]]
f1 score: 0.3869075350695408
36/36 [==============================] - 2s 39ms/step - loss: 1.1430 - accuracy: 0.3573 - top5-acc: 1.0000
buy&sell test accuracy_t: 1158 / 3393 = 0.3413
buy&sell test accuracy_o: 1158 / 5873 = 0.1972



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 4/100
lr at epoch 4: 0.00010003619536291808
127/127 [==============================] - 15s 113ms/step - loss: 2.1746 - accuracy: 0.3160 - top5-acc: 1.0000 - val_loss: 1.1209 - val_accuracy: 0.3870 - val_top5-acc: 1.0000
[[ 634  850  313]
 [1808 3008  809]
 [ 582  735  279]]
f1 score: 0.4526054064732329
36/36 [==============================] - 2s 39ms/step - loss: 1.0738 - accuracy: 0.4348 - top5-acc: 1.0000
buy&sell test accuracy_t: 913 / 3393 = 0.2691
buy&sell test accuracy_o: 913 / 4425 = 0.2063



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 5/100
lr at epoch 5: 0.00012503619655035436
127/127 [==============================] - 15s 113ms/step - loss: 2.0123 - accuracy: 0.3461 - top5-acc: 1.0000 - val_loss: 1.0463 - val_accuracy: 0.4702 - val_top5-acc: 1.0000
[[ 478 1152  167]
 [1324 3951  350]
 [ 469  981  146]]
f1 score: 0.49065450633118507
36/36 [==============================] - 2s 39ms/step - loss: 1.0185 - accuracy: 0.5073 - top5-acc: 1.0000
buy&sell test accuracy_t: 624 / 3393 = 0.1839
buy&sell test accuracy_o: 624 / 2934 = 0.2127



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 6/100
lr at epoch 6: 0.00015003619773779064
127/127 [==============================] - 15s 113ms/step - loss: 1.8793 - accuracy: 0.3797 - top5-acc: 1.0000 - val_loss: 0.9957 - val_accuracy: 0.5373 - val_top5-acc: 1.0000
[[ 345 1359   93]
 [ 829 4669  127]
 [ 327 1205   64]]
f1 score: 0.506734387929669
36/36 [==============================] - 2s 39ms/step - loss: 0.9825 - accuracy: 0.5631 - top5-acc: 1.0000
buy&sell test accuracy_t: 409 / 3393 = 0.1205
buy&sell test accuracy_o: 409 / 1785 = 0.2291



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 7/100
lr at epoch 7: 0.00017503619892522693
127/127 [==============================] - 15s 113ms/step - loss: 1.7779 - accuracy: 0.4113 - top5-acc: 1.0000 - val_loss: 0.9709 - val_accuracy: 0.5739 - val_top5-acc: 1.0000
[[ 237 1522   38]
 [ 467 5117   41]
 [ 224 1352   20]]
f1 score: 0.507660387186836
36/36 [==============================] - 2s 39ms/step - loss: 0.9668 - accuracy: 0.5959 - top5-acc: 1.0000
buy&sell test accuracy_t: 257 / 3393 = 0.0757
buy&sell test accuracy_o: 257 / 1027 = 0.2502



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.2s
Epoch 8/100
lr at epoch 8: 0.00020003618556074798
127/127 [==============================] - 15s 113ms/step - loss: 1.6883 - accuracy: 0.4416 - top5-acc: 1.0000 - val_loss: 0.9648 - val_accuracy: 0.6055 - val_top5-acc: 1.0000
[[ 152 1636    9]
 [ 245 5363   17]
 [ 140 1447    9]]
f1 score: 0.5033797457634772
36/36 [==============================] - 2s 39ms/step - loss: 0.9660 - accuracy: 0.6126 - top5-acc: 1.0000
buy&sell test accuracy_t: 161 / 3393 = 0.0475
buy&sell test accuracy_o: 161 / 572 = 0.2815



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 9/100
lr at epoch 9: 0.00022503618674818426
127/127 [==============================] - 15s 113ms/step - loss: 1.6513 - accuracy: 0.4651 - top5-acc: 1.0000 - val_loss: 0.9697 - val_accuracy: 0.6174 - val_top5-acc: 1.0000
[[ 101 1691    5]
 [ 150 5468    7]
 [ 100 1490    6]]
f1 score: 0.4979420769438497
36/36 [==============================] - 2s 39ms/step - loss: 0.9747 - accuracy: 0.6182 - top5-acc: 1.0000
buy&sell test accuracy_t: 107 / 3393 = 0.0315
buy&sell test accuracy_o: 107 / 369 = 0.29



Epoch 10/100
lr at epoch 10: 0.00025003618793562055
127/127 [==============================] - 14s 112ms/step - loss: 1.5968 - accuracy: 0.4883 - top5-acc: 1.0000 - val_loss: 0.9778 - val_accuracy: 0.6241 - val_top5-acc: 1.0000
[[  73 1721    3]
 [  88 5533    4]
 [  68 1525    3]]
f1 score: 0.49422444198059357
36/36 [==============================] - 2s 39ms/step - loss: 0.9866 - accuracy: 0.6220 - top5-acc: 1.0000
buy&sell test accuracy_t: 76 / 3393 = 0.0224
buy&sell test accuracy_o: 76 / 239 = 0.318



Epoch 11/100
lr at epoch 11: 0.00027503620367497206
127/127 [==============================] - 14s 112ms/step - loss: 1.5839 - accuracy: 0.5053 - top5-acc: 1.0000 - val_loss: 0.9839 - val_accuracy: 0.6274 - val_top5-acc: 1.0000
[[  58 1738    1]
 [  65 5557    3]
 [  50 1543    3]]
f1 score: 0.4917146074533891
36/36 [==============================] - 2s 39ms/step - loss: 0.9970 - accuracy: 0.6230 - top5-acc: 1.0000
buy&sell test accuracy_t: 61 / 3393 = 0.018
buy&sell test accuracy_o: 61 / 180 = 0.3389



Epoch 12/100
lr at epoch 12: 0.0003000361903104931
127/127 [==============================] - 14s 113ms/step - loss: 1.5650 - accuracy: 0.5132 - top5-acc: 1.0000 - val_loss: 0.9856 - val_accuracy: 0.6288 - val_top5-acc: 1.0000
[[  54 1742    1]
 [  52 5571    2]
 [  42 1551    3]]
f1 score: 0.4913915076495573
36/36 [==============================] - 2s 39ms/step - loss: 1.0034 - accuracy: 0.6241 - top5-acc: 1.0000
buy&sell test accuracy_t: 57 / 3393 = 0.0168
buy&sell test accuracy_o: 57 / 154 = 0.3701



Epoch 13/100
lr at epoch 13: 0.0003250362060498446
127/127 [==============================] - 14s 112ms/step - loss: 1.5539 - accuracy: 0.5172 - top5-acc: 1.0000 - val_loss: 0.9832 - val_accuracy: 0.6296 - val_top5-acc: 1.0000
[[  48 1748    1]
 [  48 5576    1]
 [  37 1557    2]]
f1 score: 0.48988599893320217
36/36 [==============================] - 2s 39ms/step - loss: 1.0055 - accuracy: 0.6239 - top5-acc: 1.0000
buy&sell test accuracy_t: 50 / 3393 = 0.0147
buy&sell test accuracy_o: 50 / 137 = 0.365



Epoch 14/100
lr at epoch 14: 0.0003500361926853657
127/127 [==============================] - 14s 113ms/step - loss: 1.5649 - accuracy: 0.5174 - top5-acc: 1.0000 - val_loss: 0.9797 - val_accuracy: 0.6310 - val_top5-acc: 1.0000
[[  44 1752    1]
 [  45 5578    2]
 [  35 1559    2]]
f1 score: 0.48900989783484095
36/36 [==============================] - 2s 39ms/step - loss: 1.0065 - accuracy: 0.6236 - top5-acc: 1.0000
buy&sell test accuracy_t: 46 / 3393 = 0.0136
buy&sell test accuracy_o: 46 / 129 = 0.3566



Epoch 15/100
lr at epoch 15: 0.00037503617932088673
127/127 [==============================] - 14s 113ms/step - loss: 1.5337 - accuracy: 0.5274 - top5-acc: 1.0000 - val_loss: 0.9748 - val_accuracy: 0.6321 - val_top5-acc: 1.0000
[[  46 1750    1]
 [  45 5578    2]
 [  38 1557    1]]
f1 score: 0.4893112688812205
36/36 [==============================] - 2s 39ms/step - loss: 1.0050 - accuracy: 0.6238 - top5-acc: 1.0000
buy&sell test accuracy_t: 47 / 3393 = 0.0139
buy&sell test accuracy_o: 47 / 133 = 0.3534



Epoch 16/100
lr at epoch 16: 0.00040003619506023824
127/127 [==============================] - 14s 114ms/step - loss: 1.5430 - accuracy: 0.5252 - top5-acc: 1.0000 - val_loss: 0.9687 - val_accuracy: 0.6335 - val_top5-acc: 1.0000
[[  45 1751    1]
 [  47 5576    2]
 [  36 1559    1]]
f1 score: 0.488904193698794
36/36 [==============================] - 2s 39ms/step - loss: 1.0035 - accuracy: 0.6234 - top5-acc: 1.0000
buy&sell test accuracy_t: 46 / 3393 = 0.0136
buy&sell test accuracy_o: 46 / 132 = 0.3485



Epoch 17/100
lr at epoch 17: 0.0004250361816957593
127/127 [==============================] - 14s 113ms/step - loss: 1.5275 - accuracy: 0.5261 - top5-acc: 1.0000 - val_loss: 0.9627 - val_accuracy: 0.6338 - val_top5-acc: 1.0000
[[  48 1748    1]
 [  52 5571    2]
 [  42 1553    1]]
f1 score: 0.4894862073502817
36/36 [==============================] - 2s 39ms/step - loss: 1.0004 - accuracy: 0.6232 - top5-acc: 1.0000
buy&sell test accuracy_t: 49 / 3393 = 0.0144
buy&sell test accuracy_o: 49 / 146 = 0.3356



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 18/100
lr at epoch 18: 0.0004500361974351108
127/127 [==============================] - 15s 113ms/step - loss: 1.5198 - accuracy: 0.5274 - top5-acc: 1.0000 - val_loss: 0.9562 - val_accuracy: 0.6343 - val_top5-acc: 1.0000
[[  57 1739    1]
 [  64 5559    2]
 [  46 1549    1]]
f1 score: 0.49098064511090217
36/36 [==============================] - 2s 39ms/step - loss: 0.9958 - accuracy: 0.6229 - top5-acc: 1.0000
buy&sell test accuracy_t: 58 / 3393 = 0.0171
buy&sell test accuracy_o: 58 / 171 = 0.3392



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 19/100
lr at epoch 19: 0.00047503618407063186
127/127 [==============================] - 15s 113ms/step - loss: 1.5157 - accuracy: 0.5259 - top5-acc: 1.0000 - val_loss: 0.9501 - val_accuracy: 0.6363 - val_top5-acc: 1.0000
[[  61 1735    1]
 [  63 5559    3]
 [  51 1544    1]]
f1 score: 0.49204016507580733
36/36 [==============================] - 2s 39ms/step - loss: 0.9931 - accuracy: 0.6233 - top5-acc: 1.0000
buy&sell test accuracy_t: 62 / 3393 = 0.0183
buy&sell test accuracy_o: 62 / 180 = 0.3444



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 20/100
lr at epoch 20: 0.0005000361707061529
127/127 [==============================] - 15s 113ms/step - loss: 1.5037 - accuracy: 0.5309 - top5-acc: 1.0000 - val_loss: 0.9448 - val_accuracy: 0.6363 - val_top5-acc: 1.0000
[[  71 1723    3]
 [  72 5550    3]
 [  58 1537    1]]
f1 score: 0.4940264245940471
36/36 [==============================] - 2s 39ms/step - loss: 0.9888 - accuracy: 0.6234 - top5-acc: 1.0000
buy&sell test accuracy_t: 72 / 3393 = 0.0212
buy&sell test accuracy_o: 72 / 208 = 0.3462



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 21/100
lr at epoch 21: 0.0005250361864455044
127/127 [==============================] - 15s 113ms/step - loss: 1.5063 - accuracy: 0.5310 - top5-acc: 1.0000 - val_loss: 0.9398 - val_accuracy: 0.6379 - val_top5-acc: 1.0000
[[  72 1722    3]
 [  76 5545    4]
 [  60 1535    1]]
f1 score: 0.4940092331195674
36/36 [==============================] - 2s 39ms/step - loss: 0.9862 - accuracy: 0.6230 - top5-acc: 1.0000
buy&sell test accuracy_t: 73 / 3393 = 0.0215
buy&sell test accuracy_o: 73 / 216 = 0.338



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 22/100
lr at epoch 22: 0.0005500362021848559
127/127 [==============================] - 15s 113ms/step - loss: 1.4801 - accuracy: 0.5331 - top5-acc: 1.0000 - val_loss: 0.9348 - val_accuracy: 0.6401 - val_top5-acc: 1.0000
[[  81 1712    4]
 [  89 5531    5]
 [  66 1529    1]]
f1 score: 0.4953621652581052
36/36 [==============================] - 2s 39ms/step - loss: 0.9832 - accuracy: 0.6224 - top5-acc: 1.0000
buy&sell test accuracy_t: 82 / 3393 = 0.0242
buy&sell test accuracy_o: 82 / 246 = 0.3333



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.2s
Epoch 23/100
lr at epoch 23: 0.0005750362179242074
127/127 [==============================] - 15s 113ms/step - loss: 1.4786 - accuracy: 0.5280 - top5-acc: 1.0000 - val_loss: 0.9295 - val_accuracy: 0.6396 - val_top5-acc: 1.0000
[[  86 1707    4]
 [  98 5522    5]
 [  70 1525    1]]
f1 score: 0.49601350047170195
36/36 [==============================] - 2s 39ms/step - loss: 0.9814 - accuracy: 0.6220 - top5-acc: 1.0000
buy&sell test accuracy_t: 87 / 3393 = 0.0256
buy&sell test accuracy_o: 87 / 264 = 0.3295



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 24/100
lr at epoch 24: 0.000600036175455898
127/127 [==============================] - 15s 113ms/step - loss: 1.4593 - accuracy: 0.5363 - top5-acc: 1.0000 - val_loss: 0.9251 - val_accuracy: 0.6413 - val_top5-acc: 1.0000
[[  93 1699    5]
 [ 115 5505    5]
 [  76 1519    1]]
f1 score: 0.4966700482148907
36/36 [==============================] - 2s 39ms/step - loss: 0.9782 - accuracy: 0.6209 - top5-acc: 1.0000
buy&sell test accuracy_t: 94 / 3393 = 0.0277
buy&sell test accuracy_o: 94 / 295 = 0.3186



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.2s
Epoch 25/100
lr at epoch 25: 0.0006250361911952496
127/127 [==============================] - 15s 113ms/step - loss: 1.4534 - accuracy: 0.5402 - top5-acc: 1.0000 - val_loss: 0.9202 - val_accuracy: 0.6418 - val_top5-acc: 1.0000
[[ 106 1685    6]
 [ 133 5487    5]
 [  81 1514    1]]
f1 score: 0.49848276210843007
36/36 [==============================] - 2s 39ms/step - loss: 0.9747 - accuracy: 0.6203 - top5-acc: 1.0000
buy&sell test accuracy_t: 107 / 3393 = 0.0315
buy&sell test accuracy_o: 107 / 332 = 0.3223



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 26/100
lr at epoch 26: 0.0006500362069346011
127/127 [==============================] - 15s 115ms/step - loss: 1.4353 - accuracy: 0.5392 - top5-acc: 1.0000 - val_loss: 0.9162 - val_accuracy: 0.6426 - val_top5-acc: 1.0000
[[ 115 1676    6]
 [ 140 5479    6]
 [  91 1504    1]]
f1 score: 0.5001196840605597
36/36 [==============================] - 2s 39ms/step - loss: 0.9725 - accuracy: 0.6204 - top5-acc: 1.0000
buy&sell test accuracy_t: 116 / 3393 = 0.0342
buy&sell test accuracy_o: 116 / 359 = 0.3231



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.4s
Epoch 27/100
lr at epoch 27: 0.0006750361644662917
127/127 [==============================] - 15s 113ms/step - loss: 1.4327 - accuracy: 0.5414 - top5-acc: 1.0000 - val_loss: 0.9121 - val_accuracy: 0.6446 - val_top5-acc: 1.0000
[[ 125 1666    6]
 [ 154 5465    6]
 [  99 1495    2]]
f1 score: 0.5017396181971825
36/36 [==============================] - 2s 39ms/step - loss: 0.9701 - accuracy: 0.6201 - top5-acc: 1.0000
buy&sell test accuracy_t: 127 / 3393 = 0.0374
buy&sell test accuracy_o: 127 / 392 = 0.324



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.3s
Epoch 28/100
lr at epoch 28: 0.0007000361802056432
127/127 [==============================] - 15s 113ms/step - loss: 1.4224 - accuracy: 0.5387 - top5-acc: 1.0000 - val_loss: 0.9073 - val_accuracy: 0.6454 - val_top5-acc: 1.0000
[[ 140 1650    7]
 [ 170 5449    6]
 [ 112 1481    3]]
f1 score: 0.504342552700898
36/36 [==============================] - 2s 39ms/step - loss: 0.9667 - accuracy: 0.6201 - top5-acc: 1.0000
buy&sell test accuracy_t: 143 / 3393 = 0.0421
buy&sell test accuracy_o: 143 / 438 = 0.3265



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_035925-2f5vqayx\files\model-best)... Done. 0.2s
Epoch 29/100
lr at epoch 29: 0.0007250361959449947
 11/127 [=>............................] - ETA: 12s - loss: 1.2652 - accuracy: 0.5689 - top5-acc: 1.0000forrtl: error (200): program aborting due to control-C event
Image              PC                Routine            Line        Source
libifcoremd.dll    00007FFA78AF3B58  Unknown               Unknown  Unknown
KERNELBASE.dll     00007FFAD06CB943  Unknown               Unknown  Unknown
KERNEL32.DLL       00007FFAD19C7034  Unknown               Unknown  Unknown
ntdll.dll          00007FFAD2EE2651  Unknown               Unknown  Unknown
 12/127 [=>............................] - ETA: 12s - loss: 1.2680 - accuracy: 0.5654 - top5-acc: 1.0000forrtl: error (200): program aborting due to control-C event
Image              PC                Routine            Line        Source
libifcoremd.dll    00007FFA78AF3B58  Unknown               Unknown  Unknown
KERNELBASE.dll     00007FFAD06CB943  Unknown               Unknown  Unknown
KERNEL32.DLL       00007FFAD19C7034  Unknown               Unknown  Unknown
ntdll.dll          00007FFAD2EE2651  Unknown               Unknown  Unknown