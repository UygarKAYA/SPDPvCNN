PS C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN> C:/ProgramData/Anaconda3/envs/tf/python.exe c:/Users/Tuna/Desktop/2022-spring/CS402/SPDPvCNN/training.py
2022-05-30 02:50:19.361288: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-05-30 02:50:19.723567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3495 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.6
wandb: Currently logged in as: kuantuna (spdpvcnn). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.12.17 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.16
wandb: Run data is saved locally in C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweet-rain-43
wandb:  View project at https://wandb.ai/spdpvcnn/vision_transformer
wandb:  View run at https://wandb.ai/spdpvcnn/vision_transformer/runs/3hrxj42x
Training data samples: 32465
Validation data samples: 3607
Test data samples: 9018
2022-05-30 02:50:26.624173: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
2022-05-30 02:52:07.719934: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Getting the ViT model...
wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
2022-05-30 02:52:48.703734: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
2022-05-30 02:52:48.927785: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Epoch 1/100
2022-05-30 02:52:54.484804: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2022-05-30 02:52:56.720789: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
254/254 [==============================] - 41s 130ms/step - loss: 2.0339 - accuracy: 0.4153 - top5-acc: 1.0000 - val_loss: 1.0748 - val_accuracy: 0.6252 - val_top5-acc: 1.0000
[[   6 1760   31]
 [   4 5594   27]
 [   1 1566   29]]
f1 score: 0.48721150581613903
71/71 [==============================] - 3s 42ms/step - loss: 1.0611 - accuracy: 0.6242 - top5-acc: 1.0000
buy&sell test accuracy_t: 35 / 3393 = 0.0103
buy&sell test accuracy_o: 35 / 98 = 0.3571



wandb: ERROR Can't save model in the h5py format. The model will be saved as W&B Artifacts in the SavedModel format.
2022-05-30 02:53:40.786460: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
2022-05-30 02:53:56.376247: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1165883080 exceeds 10% of free system memory.
Epoch 2/100
254/254 [==============================] - 32s 126ms/step - loss: 1.7289 - accuracy: 0.5161 - top5-acc: 1.0000 - val_loss: 1.0397 - val_accuracy: 0.6315 - val_top5-acc: 1.0000
[[   4 1747   46]
 [   2 5587   36]
 [   0 1555   41]]
f1 score: 0.4895393836525514
71/71 [==============================] - 3s 42ms/step - loss: 1.0762 - accuracy: 0.6245 - top5-acc: 1.0000
buy&sell test accuracy_t: 45 / 3393 = 0.0133
buy&sell test accuracy_o: 45 / 129 = 0.3488



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
Epoch 3/100
254/254 [==============================] - 33s 127ms/step - loss: 1.6658 - accuracy: 0.5259 - top5-acc: 1.0000 - val_loss: 1.0032 - val_accuracy: 0.6401 - val_top5-acc: 1.0000
[[   7 1726   64]
 [   3 5578   44]
 [   0 1540   56]]
f1 score: 0.4937366437700098
71/71 [==============================] - 3s 43ms/step - loss: 1.0657 - accuracy: 0.6255 - top5-acc: 1.0000
buy&sell test accuracy_t: 63 / 3393 = 0.0186
buy&sell test accuracy_o: 63 / 174 = 0.3621



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
Epoch 4/100
254/254 [==============================] - 32s 127ms/step - loss: 1.6130 - accuracy: 0.5281 - top5-acc: 1.0000 - val_loss: 0.9844 - val_accuracy: 0.6413 - val_top5-acc: 1.0000
[[   9 1709   79]
 [   4 5564   57]
 [   0 1527   69]]
f1 score: 0.49672923035513156
71/71 [==============================] - 3s 43ms/step - loss: 1.0547 - accuracy: 0.6256 - top5-acc: 1.0000
buy&sell test accuracy_t: 78 / 3393 = 0.023
buy&sell test accuracy_o: 78 / 218 = 0.3578



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
Epoch 5/100
254/254 [==============================] - 33s 127ms/step - loss: 1.6023 - accuracy: 0.5304 - top5-acc: 1.0000 - val_loss: 0.9655 - val_accuracy: 0.6451 - val_top5-acc: 1.0000
[[  12 1685  100]
 [   5 5545   75]
 [   4 1513   79]]
f1 score: 0.49919153091678814
71/71 [==============================] - 3s 43ms/step - loss: 1.0355 - accuracy: 0.6250 - top5-acc: 1.0000
buy&sell test accuracy_t: 91 / 3393 = 0.0268
buy&sell test accuracy_o: 91 / 275 = 0.3309



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
Epoch 6/100
254/254 [==============================] - 32s 127ms/step - loss: 1.5584 - accuracy: 0.5323 - top5-acc: 1.0000 - val_loss: 0.9492 - val_accuracy: 0.6462 - val_top5-acc: 1.0000
[[  13 1673  111]
 [   6 5514  105]
 [   6 1497   93]]
f1 score: 0.5008518275008125
71/71 [==============================] - 3s 42ms/step - loss: 1.0212 - accuracy: 0.6232 - top5-acc: 1.0000
buy&sell test accuracy_t: 106 / 3393 = 0.0312
buy&sell test accuracy_o: 106 / 334 = 0.3174



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
Epoch 7/100
254/254 [==============================] - 32s 127ms/step - loss: 1.5272 - accuracy: 0.5321 - top5-acc: 1.0000 - val_loss: 0.9420 - val_accuracy: 0.6482 - val_top5-acc: 1.0000
[[  13 1672  112]
 [   7 5489  129]
 [   7 1488  101]]
f1 score: 0.5010094259701203
71/71 [==============================] - 3s 42ms/step - loss: 1.0163 - accuracy: 0.6213 - top5-acc: 1.0000
buy&sell test accuracy_t: 114 / 3393 = 0.0336
buy&sell test accuracy_o: 114 / 369 = 0.3089



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
Epoch 8/100
254/254 [==============================] - 33s 127ms/step - loss: 1.4776 - accuracy: 0.5404 - top5-acc: 1.0000 - val_loss: 0.9295 - val_accuracy: 0.6471 - val_top5-acc: 1.0000
[[  11 1663  123]
 [   8 5474  143]
 [   9 1474  113]]
f1 score: 0.5023422306883453
71/71 [==============================] - 3s 43ms/step - loss: 1.0080 - accuracy: 0.6208 - top5-acc: 1.0000
buy&sell test accuracy_t: 124 / 3393 = 0.0365
buy&sell test accuracy_o: 124 / 407 = 0.3047



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.5s
Epoch 9/100
254/254 [==============================] - 33s 127ms/step - loss: 1.4679 - accuracy: 0.5369 - top5-acc: 1.0000 - val_loss: 0.9170 - val_accuracy: 0.6496 - val_top5-acc: 1.0000
[[  11 1650  136]
 [   8 5430  187]
 [  10 1451  135]]
f1 score: 0.5041865291587505
71/71 [==============================] - 3s 43ms/step - loss: 0.9989 - accuracy: 0.6183 - top5-acc: 1.0000
buy&sell test accuracy_t: 146 / 3393 = 0.043
buy&sell test accuracy_o: 146 / 487 = 0.2998



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.5s
Epoch 10/100
254/254 [==============================] - 32s 127ms/step - loss: 1.4224 - accuracy: 0.5454 - top5-acc: 1.0000 - val_loss: 0.9049 - val_accuracy: 0.6476 - val_top5-acc: 1.0000
[[   9 1617  171]
 [   9 5387  229]
 [   8 1423  165]]
f1 score: 0.5072393013071282
71/71 [==============================] - 3s 43ms/step - loss: 0.9884 - accuracy: 0.6167 - top5-acc: 1.0000
buy&sell test accuracy_t: 174 / 3393 = 0.0513
buy&sell test accuracy_o: 174 / 591 = 0.2944



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.5s
Epoch 11/100
254/254 [==============================] - 33s 127ms/step - loss: 1.3912 - accuracy: 0.5466 - top5-acc: 1.0000 - val_loss: 0.8960 - val_accuracy: 0.6476 - val_top5-acc: 1.0000
[[   8 1611  178]
 [   9 5381  235]
 [   6 1426  164]]
f1 score: 0.5064849272783998
71/71 [==============================] - 3s 42ms/step - loss: 0.9809 - accuracy: 0.6158 - top5-acc: 1.0000
buy&sell test accuracy_t: 172 / 3393 = 0.0507
buy&sell test accuracy_o: 172 / 600 = 0.2867



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.4s
Epoch 12/100
254/254 [==============================] - 33s 127ms/step - loss: 1.3622 - accuracy: 0.5493 - top5-acc: 1.0000 - val_loss: 0.8903 - val_accuracy: 0.6479 - val_top5-acc: 1.0000
[[   5 1579  213]
 [   5 5322  298]
 [   5 1402  189]]
f1 score: 0.5069181786619563
71/71 [==============================] - 3s 43ms/step - loss: 0.9754 - accuracy: 0.6117 - top5-acc: 1.0000
buy&sell test accuracy_t: 194 / 3393 = 0.0572
buy&sell test accuracy_o: 194 / 715 = 0.2713



WARNING:absl:Found untraced functions such as dense_layer_call_and_return_conditional_losses, dense_layer_call_fn, embedding_layer_call_and_return_conditional_losses, embedding_layer_call_fn, query_layer_call_and_return_conditional_losses while saving (showing 5 of 310). These functions will not be directly callable after loading.
C:\ProgramData\Anaconda3\envs\tf\lib\site-packages\keras\utils\generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  warnings.warn('Custom mask layers require a config and must override '
wandb: Adding directory to artifact (C:\Users\Tuna\Desktop\2022-spring\CS402\SPDPvCNN\wandb\run-20220530_025020-3hrxj42x\files\model-best)... Done. 0.5s
Epoch 13/100
155/254 [=================>............] - ETA: 12s - loss: 1.2784 - accuracy: 0.5731 - top5-acc: 1.0000forrtl: error (200): program aborting due to control-C event
Image              PC                Routine            Line        Source
libifcoremd.dll    00007FFA78AF3B58  Unknown               Unknown  Unknown
KERNELBASE.dll     00007FFAD06CB943  Unknown               Unknown  Unknown
KERNEL32.DLL       00007FFAD19C7034  Unknown               Unknown  Unknown
ntdll.dll          00007FFAD2EE2651  Unknown               Unknown  Unknown
156/254 [=================>............] - ETA: 12s - loss: 1.2814 - accuracy: 0.5723 - top5-acc: 1.0000forrtl: error (200): program aborting due to control-C event
Image              PC                Routine            Line        Source
libifcoremd.dll    00007FFA78AF3B58  Unknown               Unknown  Unknown
KERNELBASE.dll     00007FFAD06CB943  Unknown               Unknown  Unknown
KERNEL32.DLL       00007FFAD19C7034  Unknown               Unknown  Unknown
ntdll.dll          00007FFAD2EE2651  Unknown               Unknown  Unknown